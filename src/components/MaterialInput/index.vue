<script setup>
import { computed, defineProps, onUpdated, ref, watch } from 'vue';
import { nanoid } from 'nanoid';

const props = defineProps({
  label: String,
  type: String,
  inputValue: String,
  onUpdate:Function,
  style:Object
});
const label = props.label;
const type = props.type;
const inputId = nanoid();


const isShowPwd = ref(false);
const inputType = computed(()=>{
    if(type === 'password' && isShowPwd.value){
        return 'text'
    }
    return type || 'text'
})
const handleInput = (event) => {
  const value = event.target.value;

  props.onUpdate && props.onUpdate(value);
};
</script>

<template>
    <div class="form-item" :style="props.style">
        <input required :type="inputType" :value="props.inputValue " :id="inputId" @input="handleInput">
        <span class="pwd-icon" v-if="type === 'password'" @click="isShowPwd = !isShowPwd">
            <svg v-if="!isShowPwd" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8452" width="16" height="16"><path d="M0 0h1024v1024H0z" fill="#FFFFFF" fill-opacity=".01" p-id="8453"></path><path d="M521.152 160c119.168 0 235.072 54.464 343.68 144.512a960 960 0 0 1 82.88 77.568l22.208 24.192 21.888 25.536 8.768 10.944 17.664 23.552-14.336 19.136-7.36 9.472-16.256 19.52-14.08 16.128a967.68 967.68 0 0 1-101.376 97.536c-108.608 89.984-224.512 144.448-343.68 144.448-119.232 0-235.072-54.4-343.68-144.448A960 960 0 0 1 94.528 550.4l-25.792-28.224-18.304-21.44-8.768-11.008-17.6-23.488 14.272-19.2 12.16-15.36 18.24-21.376 7.424-8.32a967.68 967.68 0 0 1 101.312-97.536C286.08 214.4 401.92 160 521.152 160z m0 64c-101.76 0-204.608 48.384-302.848 129.792A904.32 904.32 0 0 0 123.712 444.8l-18.752 21.44 11.904 13.824 24.064 26.24c23.552 24.832 49.472 49.28 77.44 72.512 98.176 81.344 201.024 129.728 302.72 129.728 101.76 0 204.672-48.384 302.912-129.728a896.64 896.64 0 0 0 77.376-72.448l17.216-18.624 12.992-14.72 5.632-6.784-5.632-6.592-12.992-14.848a904.32 904.32 0 0 0-94.592-91.008C725.76 272.384 622.848 224 521.152 224z m0 96a146.304 146.304 0 1 1 0 292.544 146.304 146.304 0 0 1 0-292.544z m0 64a82.304 82.304 0 1 0 0 164.544 82.304 82.304 0 0 0 0-164.544z" fill="#ABAEB7" p-id="8454"></path></svg>
            <svg v-else class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9489" width="16" height="16"><path d="M310.710857 323.291429a33.304381 33.304381 0 0 0 15.652572-4.242286c162.377143-87.673905 311.929905-69.339429 448.609523 55.003428l43.154286 39.302096a136.874667 136.874667 0 0 1 0 202.947047l-43.105524 39.350857a429.592381 429.592381 0 0 1-47.396571 37.205334 31.061333 31.061333 0 0 0-14.774857 26.624 31.548952 31.548952 0 1 0 49.493333 26.233905c19.407238-12.970667 37.888-27.355429 55.344762-43.154286l43.154286-39.302095a200.606476 200.606476 0 0 0 0-296.862477l-43.154286-39.302095c-158.96381-144.62781-332.897524-165.888-521.752381-63.878095a32.085333 32.085333 0 0 0-16.920381 28.379428c0 17.310476 13.945905 31.695238 31.695238 31.695239z m-63.000381 37.64419c0 9.264762-4.193524 17.749333-10.532571 23.649524l-31.305143 28.769524a136.874667 136.874667 0 0 0 0 202.947047l43.105524 39.350857c106.008381 96.402286 228.059429 125.70819 366.201904 87.917715a31.695238 31.695238 0 0 1 40.569905 30.427428 31.695238 31.695238 0 0 1-24.088381 30.915048c-160.426667 43.690667-302.177524 9.557333-425.350095-102.351238l-43.154286-39.302095a200.606476 200.606476 0 0 1 0-296.862477l31.305143-28.769523a32.670476 32.670476 0 0 1 21.552762-8.43581c17.359238 0 31.695238 14.384762 31.695238 31.695238z m184.807619 86.649905a30.183619 30.183619 0 0 0 19.846095-7.168 93.574095 93.574095 0 0 1 59.63581-20.72381c52.419048 0 95.134476 42.715429 95.134476 95.134476 0 21.699048-6.631619 41.008762-19.894857 57.929143a31.939048 31.939048 0 0 0 24.966095 51.590096 32.475429 32.475429 0 0 0 25.356191-12.678096c21.991619-28.476952 33.01181-60.757333 33.011809-96.841143A158.622476 158.622476 0 0 0 512 356.254476c-37.205333 0-70.314667 11.556571-99.376762 34.669714a32.182857 32.182857 0 0 0-11.849143 24.966096c0 17.749333 13.994667 31.695238 31.695238 31.695238z m-13.945905 84.992a31.792762 31.792762 0 1 0-62.610285 11.849143 159.012571 159.012571 0 0 0 118.832762 124.732952c2.535619 0.438857 5.071238 0.828952 8.045714 0.828952 17.310476 0 31.695238-14.336 31.695238-31.695238a31.744 31.744 0 0 0-24.966095-30.866285 94.890667 94.890667 0 0 1-70.997334-74.849524z" fill="#999999" p-id="9490"></path><path d="M134.485333 239.85981L764.586667 870.009905c4.87619 4.87619 11.215238 7.704381 18.529523 7.704381a26.428952 26.428952 0 0 0 26.282667-26.233905c0-7.363048-2.779429-13.653333-7.704381-18.578286L171.641905 202.752A25.648762 25.648762 0 0 0 153.063619 195.047619a26.428952 26.428952 0 0 0-26.282667 26.233905c0 7.363048 2.779429 13.653333 7.704381 18.578286z" fill="#999999" p-id="9491"></path></svg>
        </span>
        
        <span class="bar"></span>
        <label :for="inputId">{{label}}</label>
    </div>
</template>

<style scoped>
.form-item{
    position: relative;
    margin:50px;
}
.form-item>input{
    border:none;
    border-bottom: 1px solid #999;
    width: 100%;
    padding-bottom: 5px;
}
.form-item>.bar{
    border-bottom: 2px solid #333;
    position: absolute;
    display: block;
    bottom:0px;
    width: 0;
    left:50%;
    transition: 0.3s all;
    transform: translateX(-50%);
}
.form-item>.pwd-icon{
    position:absolute;
    top:5px;
    right:6px;
    cursor: pointer;
}
.form-item>label{
    position: absolute;
    inset: 0;
    color:#999;
    transition: 0.3s all;
}
.form-item>input:focus ~ .bar{
    width: 100%;
}
.form-item>input:focus ~ label{
    color:#333;
    transform: translateY(-30px);
    font-size: 18px;
}
.form-item>input:focus-visible{
    outline: none;
}
.form-item>input:valid ~ label{
    color:#666;
    transform: translateY(-30px);
    font-size: 18px;
}
</style>